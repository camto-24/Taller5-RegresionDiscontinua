# Mostrar resultados con stargazer
tabla_cluster <- capture.output(
stargazer(modelo1,
type = "latex",
se = list(cluster_se),   # errores agrupados
dep.var.labels = "Participación escolar",
covariate.labels = c("Cobertura de TV Globo (1998)"),
title = "Efecto de Globo sobre la participación escolar",
label = "tab:globo_cluster",
out = "Tablas/modelo_globo_cluster.tex",
digits = 3,
notes = "Errores estándar agrupados por provincia.")
)
# Quitar comentarios de stargazer (para un .tex limpio)
tabla_cluster <- tabla_cluster[!grepl("^%", tabla_cluster)]
# Mostrar tabla en consola (opcional)
cat(tabla_cluster, sep = "\n")
# Regresión para mujeres
modelo_f <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Regresión para hombres
modelo_m <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Errores estándar agrupados por provincia para cada modelo
se_f <- sqrt(diag(vcov(modelo_f)))
se_m <- sqrt(diag(vcov(modelo_m)))
# Regresión para mujeres
modelo_f <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Regresión para hombres
modelo_m <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Errores estándar agrupados por provincia para cada modelo
se_f <- sqrt(diag(vcov(modelo_f)))
se_m <- sqrt(diag(vcov(modelo_m)))
# Tabla
tabla_fixest <- capture.output(
stargazer(modelo_f, modelo_m,
type = "latex",
se = list(se_f, se_m),     # pasan los errores agrupados
dep.var.labels = c("Escolarización femenina", "Escolarización masculina"),
column.labels = c("Mujeres", "Hombres"),
covariate.labels = c(
"Cobertura Globo (i98)",
"X",
"X_m",
"Islam 1994",
"Número de partidos",
"Población 1994",
"Edad 19",
"Edad 60",
"Sexo",
"Shhs",
"Merkezi",
"Merkezp",
"Subbuyuk",
"Buyuk"
),
title = "Impacto de Globo sobre escolarización por género",
label = "tab:globo_genero",
out = "Tablas/modelos_globo_genero.tex",
digits = 3,
notes = "Errores estándar agrupados por provincia.")
)
# Quitar comentarios
tabla_fixest <- tabla_fixest[!grepl("^%", tabla_fixest)]
# Imprimir en consola
cat(tabla_fixest, sep = "\n")
# Imprimir en consola
cat(tabla_fixest, sep = "\n")
# Regresión para mujeres
modelo_f <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Regresión para hombres
modelo_m <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Errores estándar agrupados por provincia para cada modelo
se_f <- sqrt(diag(vcov(modelo_f)))
se_m <- sqrt(diag(vcov(modelo_m)))
# Tabla
tabla_fixest <- capture.output(
stargazer(modelo_f, modelo_m,
type = "latex",
se = list(se_f, se_m),     # errores agrupados
dep.var.labels = c("Escolarización femenina", "Escolarización masculina"),
column.labels = c("Mujeres", "Hombres"),
covariate.labels = c(
"Cobertura Globo (i98)",
"X",
"X_m",
"Islam 1994",
"Número de partidos",
"Población 1994",
"Edad 19",
"Edad 60",
"Sexo",
"Shhs",
"Merkezi",
"Merkezp",
"Subbuyuk",
"Buyuk"
),
title = "Impacto de Globo sobre escolarización por género",
label = "tab:globo_genero",
out = "Tablas/modelos_globo_genero.tex",
digits = 3,
notes = "Errores estándar agrupados por provincia.")
)
# Quitar comentarios
tabla_fixest <- tabla_fixest[!grepl("^%", tabla_fixest)]
# Imprimir en consola
cat(tabla_fixest, sep = "\n")
modelo_f_lm <- lm(hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia)
modelo_m_lm <- lm(hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia)
library(lmtest)
library(sandwich)
# Errores estándar agrupados
se_f <- sqrt(diag(vcovCL(modelo_f_lm, cluster = ~prov_num)))
se_m <- sqrt(diag(vcovCL(modelo_m_lm, cluster = ~prov_num)))
# Ahora sí funciona stargazer
stargazer(modelo_f_lm, modelo_m_lm, se = list(se_f, se_m),
type = "latex",
dep.var.labels = c("Escolarización femenina", "Escolarización masculina"),
column.labels = c("Mujeres", "Hombres"),
out = "Tablas/modelos_globo_genero.tex")
# Modelos con lm()
modelo_f_lm <- lm(hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia)
modelo_m_lm <- lm(hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia)
# Errores estándar agrupados por provincia
se_f <- sqrt(diag(vcovCL(modelo_f_lm, cluster = ~prov_num)))
se_m <- sqrt(diag(vcovCL(modelo_m_lm, cluster = ~prov_num)))
# Exportar con stargazer y capturar la salida
tabla_cluster <- capture.output(
stargazer(modelo_f_lm, modelo_m_lm, se = list(se_f, se_m),
type = "latex",
dep.var.labels = c("Escolarización femenina", "Escolarización masculina"),
column.labels = c("Mujeres", "Hombres"),
covariate.labels = c(
"Cobertura Globo (i98)",
"X",
"X_m",
"Islam 1994",
"Número de partidos",
"Población 1994",
"Edad 19",
"Edad 60",
"Sexo",
"Shhs",
"Merkezi",
"Merkezp",
"Subbuyuk",
"Buyuk"
),
title = "Impacto de Globo sobre escolarización por género",
label = "tab:globo_genero",
digits = 3,
notes = "Errores estándar agrupados por provincia.")
)
# Quitar comentarios de stargazer (para un .tex limpio)
tabla_cluster <- tabla_cluster[!grepl("^%", tabla_cluster)]
# Guardar en archivo .tex
writeLines(tabla_cluster, "Tablas/modelos_globo_genero.tex")
# Mostrar tabla en consola (opcional)
cat(tabla_cluster, sep = "\n")
library(fixest)
# Filtrar submuestra
turquia_sub <- subset(turquia, X >= -0.24 & X <= 0.24)
# Modelos en la submuestra
modelo_f_sub <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
modelo_m_sub <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
# Exportar tabla con etable (ya incluye clustering)
etable(modelo_f_sub, modelo_m_sub,
depvar = c("Escolarización femenina", "Escolarización masculina"),
se = "cluster",
cluster = ~prov_num,
title = "Impacto de Globo sobre escolarización por género (submuestra X ∈ [-0.24, 0.24])",
tex = TRUE,
file = "Tablas/modelos_globo_genero_sub.tex")
library(fixest)
# Filtrar submuestra
turquia_sub <- subset(turquia, X >= -0.24 & X <= 0.24)
# Modelos en la submuestra
modelo_f_sub <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
modelo_m_sub <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
# Exportar tabla con etable (clustering automático)
etable(modelo_f_sub, modelo_m_sub,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,
file = "Tablas/modelos_globo_genero_sub.tex",
title = "Impacto de Globo sobre escolarización por género (submuestra X ∈ [-0.24, 0.24])",
model.names = c("Mujeres", "Hombres"))  # Nombres de las columnas
library(fixest)
# Filtrar submuestra
turquia_sub <- subset(turquia, X >= -0.24 & X <= 0.24)
# Modelos en la submuestra
modelo_f_sub <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
modelo_m_sub <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
# Exportar tabla a LaTeX con etable
etable(
modelo_f_sub, modelo_m_sub,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,
file = "Tablas/modelos_globo_genero_sub.tex",
title = "Impacto de Globo sobre escolarización por género (submuestra X ∈ [-0.24, 0.24])",
dict = c(hischshr1520f = "Escolarización femenina",
hischshr1520m = "Escolarización masculina",
i98 = "Cobertura Globo (i98)"),
keep = c("i98", "X", "X_m", "vshr_islam1994", "partycount", "lpop1994",
"ageshr19", "ageshr60", "sexr", "shhs", "merkezi", "merkezp",
"subbuyuk", "buyuk")  # orden de las variables
)
# Filtrar submuestra
turquia_sub <- subset(turquia, X >= -0.24 & X <= 0.24)
# Modelos en la submuestra
modelo_f_sub <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
modelo_m_sub <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub,
cluster = ~prov_num
)
# Exportar tabla a LaTeX con etable
etable(
modelo_f_sub, modelo_m_sub,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,
file = "Tablas/modelos_globo_genero_sub.tex",
title = "Impacto de Globo sobre escolarización por género (submuestra X ∈ [-0.24, 0.24])",
dict = c(hischshr1520f = "Escolarización femenina",
hischshr1520m = "Escolarización masculina",
i98 = "Cobertura Globo (i98)"),
keep = c("i98", "X", "X_m", "vshr_islam1994", "partycount", "lpop1994",
"ageshr19", "ageshr60", "sexr", "shhs", "merkezi", "merkezp",
"subbuyuk", "buyuk")
)
# Filtrar la submuestra dentro del rango -0.12 a 0.12
turquia_sub_h2 <- subset(turquia, X >= -0.12 & X <= 0.12)
# Modelo Mujeres
modelo_f_h2 <- feols(
hischshr1520f ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub_h2,
cluster = ~prov_num
)
# Modelo Hombres
modelo_m_h2 <- feols(
hischshr1520m ~ i98 + X + X_m +
vshr_islam1994 + partycount + lpop1994 +
ageshr19 + ageshr60 + sexr + shhs +
merkezi + merkezp + subbuyuk + buyuk +
factor(prov_num),
data = turquia_sub_h2,
cluster = ~prov_num
)
# Exportar tabla a LaTeX
etable(
modelo_f_h2, modelo_m_h2,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,  # Genera LaTeX
file = "Tablas/modelos_globo_genero_sub_h2.tex",
title = "Impacto de Globo sobre escolarización por género (submuestra X ∈ [-0.12, 0.12])",
dict = c(
hischshr1520f = "Escolarización femenina",
hischshr1520m = "Escolarización masculina",
i98 = "Cobertura Globo (i98)"
),
keep = c("i98", "X", "X_m", "vshr_islam1994", "partycount", "lpop1994",
"ageshr19", "ageshr60", "sexr", "shhs", "merkezi", "merkezp",
"subbuyuk", "buyuk")
)
ggplot(turquia, aes(x = X)) +
geom_histogram(binwidth = 0.02, color = "white", fill = "blue", boundary = 0) +
geom_vline(xintercept = 0, color = "red", linetype = "dashed", linewidth = 1) +
labs(
title = "Distribución de la variable de asignación (X)",
x = "Variable de asignación (X)",
y = "Frecuencia"
) +
theme_minimal()
# Guardar en archivo PNG
ggsave("Tablas/distribucion_X.png", plot = grafico_X, width = 8, height = 5, dpi = 300)
# Crear el gráfico de la distribución
grafico_X <- ggplot(turquia, aes(x = X)) +
geom_histogram(binwidth = 0.02, color = "white", fill = "blue", boundary = 0) +
geom_vline(xintercept = 0, color = "red", linetype = "dashed", linewidth = 1) +
labs(
title = "Distribución de la variable de asignación (X)",
x = "Variable de asignación (X)",
y = "Frecuencia"
) +
theme_minimal()
# Mostrar en consola
grafico_X
# Guardar en archivo PNG
ggsave("Figuras/distribucion_X.png", plot = grafico_X, width = 8, height = 5, dpi = 300)
# Crear el gráfico de densidad (curva kernel)
grafico_kernel <- ggplot(turquia, aes(x = X)) +
geom_density(fill = "blue", alpha = 0.5) +       # Curva kernel
geom_vline(xintercept = 0, color = "red", linetype = "dashed", linewidth = 1) +
labs(
title = "Distribución de la variable de asignación (X) - Kernel",
x = "Variable de asignación (X)",
y = "Densidad"
) +
theme_minimal()
# Mostrar en consola
grafico_kernel
# Guardar el gráfico
ggsave("Tablas/curva_kernel_X.png", plot = grafico_kernel, width = 8, height = 5, dpi = 300)
modelsummary(
list("1984: Alcalde islámico" = mod_i89,
"Log Población 1994" = mod_lpop),
vcov = list(se_i89, se_lpop),
stars = TRUE,
gof_omit = 'AIC|BIC|Log.Lik',
title = "Tabla: Pruebas de continuidad (sin controles, con f(X))",
add_rows = data.frame(
term = c("Controles", "Ancho de banda"),
`1984: Alcalde islámico` = c("No", "0.24"),
`Log Población 1994` = c("No", "0.24")
),
output = "punto4b.docx"
)
# Modelo para i89
modelo_i89 <- feols(
i89 ~ i98 + X + I(X^2) + factor(prov_num),
data = turquia_rd,
cluster = ~prov_num
)
# Modelo para i89
modelo_i89 <- feols(
i89 ~ i98 + X + I(X^2) + factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Modelo para lpop1994
modelo_lpop <- feols(
lpop1994 ~ i98 + X + I(X^2) + factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Tabla de resultados
etable(
modelo_i89, modelo_lpop,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,  # TRUE para LaTeX, FALSE para consola
file = "Tablas/continuidad_rd.tex",
title = "Regresión Discontinua: Prueba de continuidad sin controles",
dict = c(
i89 = "Elección de alcalde islámico 1984",
lpop1994 = "Log Población 1994",
i98 = "Cobertura Globo (i98)",
X = "X",
I(X^2) = "X al cuadrado"
# Modelo para i89
modelo_i89 <- feols(
i89 ~ i98 + X + I(X^2) + factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Modelo para lpop1994
modelo_lpop <- feols(
lpop1994 ~ i98 + X + I(X^2) + factor(prov_num),
data = turquia,
cluster = ~prov_num
)
# Tabla de resultados
etable(
modelo_i89, modelo_lpop,
se = "cluster",
cluster = ~prov_num,
tex = TRUE,  # TRUE para LaTeX, FALSE para consola
file = "Tablas/continuidad_rd.tex",
title = "Regresión Discontinua: Prueba de continuidad sin controles",
dict = c(
i89 = "Elección de alcalde islámico 1984",
lpop1994 = "Log Población 1994",
i98 = "Cobertura Globo (i98)",
X = "X",
"I(X^2)" = "X al cuadrado"
),
keep = c("i98", "X", "I(X^2)")
)
